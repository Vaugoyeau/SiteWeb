---
title: Recherche d'un prénom pour un-e enfant  
author: "Marie Vaugoyeau"
date: '2020-06-12'
slug: recherche-prenom
categories:
- open data
- stat
tags:
- open data
- stat
featuredpath: "/images/featured/"
featured: "PetitAnjou.png"
featuredalt: "Fouille de données en open data pour trouver un prénom correspondant aux critères choisis"
linktitle: "recherche-prenom"
images: 
  - /img/featured/PetitAnjou.png  
description : "Utilisation de l'open data de l'INSEE pour trouver un prénom correspondant aux critères choisis" 
output:
  blogdown::html_page:
    toc: true
---
  
# Objectif  
  
Le but de cet article est de voir comment on peut trouver une information correspondant à un certain nombre de critères dans un fichier d'open data créé par l'INSEE.  
  
Ici, nous allons chercher un prénom :  

- pour un garçon  
- pas de prénom composé  
- ne commençant pas par `S` car quand ton nom de famille commence par `M`, il y a mieux ^^  
- qui ne soit pas déjà présent dans la famille, ce qui en retire une petite quarantaine  
- courant mais sans être dans parmis les plus donnés non plus  
- qui ne soit pas un mot de la langue française, par exemple, pas de `Pierre`, `Colin`, `Iris`,...  
  
  
# Récupération des données en open source de l'INSEE  
  
L'INSEE a sortie un fichier des prénoms de 1900 à 2018, disponible sur [le site de l'open data du gouvernement français](https://www.data.gouv.fr/fr/datasets/ficher-des-prenoms-de-1900-a-2018/).  
  
```{r recuperation_fichier_prenom_insee}

library(tidyverse)

liste_prenom_insee <- read.csv2(
  "nat2018.csv",
  encoding = "UTF-8"
) %>% 
  filter(
    annais != "XXXX", # on retire les lignes sans années
    preusuel != "_PRENOMS_RARES" # on retire les prénoms non communiquées, c'est-à-dire ceux dont le nombre est inférieur à 3 pour une année
  ) %>% 
  mutate(annais = annais %>% as.integer())
  

```
  
  
# Application des filtres choisis  
  
## Sélection des prénoms masculins uniquement  
  
```{r prenom_masculin}

liste_prenom_m <- liste_prenom_insee %>% 
  filter(X.U.FEFF.sexe == 1) %>% 
  select(- X.U.FEFF.sexe)

```
  
  
## Sélection des prénoms simples  
  
```{r retire_prenoms_composes}

liste_prenom_simple <- liste_prenom_m %>% 
  filter(
    preusuel %>% 
      str_detect("-") == FALSE
  )

```
  
  
## Ne commençant pas par `S`  
  
```{r retire_prenom_commencant_par_s}

liste_prenom_sans_s <- liste_prenom_simple %>% 
  mutate(
    initiale = 
      preusuel %>% 
      str_sub(
        start = 1,
        end = 1
      )
  ) %>% 
  filter(
    initiale != "S"
  )

```
  
  
## N'étant pas présent dans la famille et ami-s  
  
```{r liste_prenom_famille}

prenom_dans_la_famille <- tibble(
  prenom = c(
    "Pierre",
    "Pierre-Yves",
    "Alain",
    "Philippe",
    "Christophe",
    "Éric",
    "Stéphane",
    "David",
    "Étienne",
    "Antoine",
    "Clovis",
    "François",
    "Quentin",
    "Jean-Baptiste",
    "Rafael",
    "Zacharrie",
    "Anatole",
    "Auguste",
    "Françis",
    "Christian",
    "Jean-Luc",
    "Thierry",
    "Eric",
    "Jérôme",
    "Sylvain",
    "Grégoire",
    "Greg",
    "Benoît",
    "Alexis",
    "Julien",
    "Florian",
    "Mael",
    "Maël",
    "Gabriel",
    "Edouard",
    "Tom",
    "Mathias"
  )
) %>% 
  mutate(
    prenom = prenom %>% str_to_upper()
  )


prenom_dans_les_amis <- tibble(
  prenom = c(
    "Thomas",
    "Benoit",
    "Joao",
    "Florian",
    "Bertrand",
    "Aubin",
    "Sébastien",
    "Arthur",
    "Clément",
    "Goulven",
    "Brieuc",
    "Jerome",
    "Jérome",
    "Laurent",
    "Joan",
    "Romain",
    "Armand"
    )
) %>% 
  mutate(
    prenom = prenom %>% str_to_upper()
  )

liste_prenom_sans_proche <- 
  liste_prenom_sans_s %>% 
  anti_join(
    prenom_dans_la_famille,
    by = c("preusuel" = "prenom")
  ) %>% 
  anti_join(
    prenom_dans_les_amis,
    by = c("preusuel" = "prenom")
  )

```
  
  
## Prénoms courants mais pas trop donnés ces dernières années  
  
Avec mon mari nous avons deux prénoms très courant qui nous ont valu à l'école de n'être quasiment jamais la seule personne à le porter ce qui conduit à des ajout d'adjectif ou de numéros pour nous différencier et ce n'est pas super plaisant...  
  
Même aujourd'hui, nos connaissances connaissent d'autres couples qui portent les mêmes prénoms ce qui peut conduire à des quiproquo plus ou moins drôles...  
  
Bref, nous voulons éviter cela donc nous avons choisi de retirer les 20 prénoms les plus données pour ces cinq dernières années.  
  
A l'inverse on ne veut pas d'un prénom que les gens ne connaissent pas, donc on pose la limite que sur les cinquantes dernières années, au moins 20 personnes par an ont eu ce prénom.  
  
*Attention* : les données de l'INSEE s'arrête en 2018, donc pour avoir l'année 2019, on va la récupérer sur le site du magazine [Parents](https://www.parents.fr/prenoms/top-100-des-prenoms-de-garcons-100988).  
  
```{r prenom_courant_mais_pas_star}

liste_prenom_rare <- liste_prenom_m %>% 
  filter(
    annais >= 1970,
    nombre < 20
  ) %>% 
  distinct(preusuel)

liste_prenom_tendance_2015_2018 <- liste_prenom_m %>% 
  filter(
    annais >= 2015
  ) %>% 
  group_by(annais) %>% 
  arrange(desc(nombre)) %>% 
  slice(1:20) %>% 
  ungroup() %>% 
  distinct(preusuel)

library(rvest)

liste_prenom_tendance_2019 <-
  tibble(
    preusuel = read_html("https://www.parents.fr/prenoms/top-100-des-prenoms-de-garcons-100988") %>% # adresse url de la page
      html_node(xpath = '//*[@id="main"]/article/div/div/div[1]/ol') %>% # sélection du tableau, xpath récupéré en "inspectant" la page internet
      html_text() %>% 
      str_split("\n\t\t", simplify = TRUE) %>% 
      str_remove_all("[:blank:]")
  ) %>% 
  filter(preusuel != "") %>% 
  slice(1:20) %>% 
  mutate(
    preusuel = preusuel %>% str_to_upper()
  )
  
liste_prenom_tendance <- 
  bind_rows(
    liste_prenom_tendance_2015_2018,
    liste_prenom_tendance_2019
  ) %>% 
  distinct()
# bon étonnament l'intégralité de la liste de 2019 est déjà dans celle de 2015 et 2018 donc ces informations ne semblent pas correct.... Pour avoir fait le tour de plusieurs sites, la liste ne bouge pas entre 2018, 2019 et 2020 donc je suppose que les personnes ayant rédigé les différents articles n'ont pas relévés que les données de l'INSEE s'arrête en 2018.... Bon tant pis...

# maintenant on retire les prénoms rares et courant de notre liste déjà réduite
liste_prenom_courant <- liste_prenom_sans_proche %>% 
  filter(annais >= 1970) %>% 
  anti_join(liste_prenom_rare) %>% 
  anti_join(liste_prenom_tendance)

```
  
  
## Prénom qui ne soit qu'un prénom    
  
Pour faire cette partie j'ai utilisée la liste des mots français de [FREELANG](https://www.freelang.com/dictionnaire/dic-francais.php), le soucis c'est que cette liste contient des prénoms mais à chaque fois ils ont une majuscule, je vais donc retirer de cette liste tous les mots commençants par une majuscule et là merci les expressions régulières !  
  
```{r retire_les_objets_lieu_et_autre}

liste_mots_francais <- read.table(
  "liste_francais.txt"
) %>% 
  filter(
    V1 %>% 
      str_detect("^[:upper:]") == TRUE
  )

```
  
Bon mon idée n'est pas la bonne car cela supprime aussi les noms de lieux et je ne veux pas...  
Après avoir regardé rapidement la liste, je me suis apperçu que seul "Ange" serait concerné donc je vais laisser de côté cette partie.  
En même temps, il est vrai que cela touche plus les prénoms donnés aux filles plutôt qu'au garçons...    
  
# Conclusion  
  
Je me retrouve avec une liste de `liste_prenom_courant %>% distinct(preusuel) %>% nrow()` prénoms soit beaucoup moins que tous les prénoms possibles ^^  
Est-ce que cela va nous aider à décider, pas sûre mais bon au moins j'aurais tenté !  
  
Une dernière idée, choisir l'initiale que l'on souhaite ?  
  
```{r choix_initiale}

liste_prenom_courant %>% 
  filter(initiale == "B") %>% 
  ggplot() +
  aes(x = annais, y = nombre, colour = preusuel) +
  geom_line() +
  theme_classic()

```

  
